<!doctype html>
<html ng-app="myApp">
<head>
    <meta charset="utf-8">
    <!-- TODO: dynamic title -->
    <title>Material Swagger UI Demo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>

    <!-- styles CDN -->
    <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:300,400,500,700,400italic">
    <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/angular_material/1.0.5/angular-material.min.css">

    <!-- inject:css -->
    <link rel="stylesheet" href="../bower_components/github-markdown-css/github-markdown.css">
    <link rel="stylesheet" href="./styles/swagger-ui-material.css">
    <link rel="stylesheet" href="./directives/toolbar-search.css">
    <link rel="stylesheet" href="./directives/toolbar-edit.css">
    <!-- endinject -->

    <style>
        .ng-cloak {
            display: none;
        }
    </style>
</head>
<body ng-controller="MyCtrl" layout="column" class="ng-cloak">
<div layout="row"
     flex
     swagger-ui-material
     swagger-methods="swaggerMethods"
     url="swaggerUrl"
     loading="isLoading"
     api-explorer="true"
     validator-url="false"
     trusted-sources="false"
     error-handler="myErrorHandler"></div>

<!-- scripts CDN -->
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular-animate.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular-aria.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular-messages.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angular_material/1.0.5/angular-material.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular-sanitize.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/showdown/1.3.0/showdown.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/js-yaml/3.5.3/js-yaml.min.js"></script>

<!-- inject:js -->
<script src="./scripts/swagger-ui.js"></script>
<script src="./scripts/swagger-ui.ctrl.js"></script>
<script src="./services/client.service.js"></script>
<script src="./services/model.service.js"></script>
<script src="./services/modules.service.js"></script>
<script src="./services/loader.service.js"></script>
<script src="./modules/parser.module.js"></script>

<script src="./scripts/swagger-ui-material.js"></script>
<script src="./services/http-info.service.js"></script>
<script src="../bower_components/showdown/dist/showdown.js"></script>
<script src="../bower_components/angular-markdown-filter/markdown.js"></script>
<script src="./modules/sort.module.js"></script>
<script src="./modules/markdown.module.js"></script>
<script src="./modules/yaml.module.js"></script>
<script src="./modules/split.module.js"></script>
<script src="./modules/transform.module.js"></script>
<script src="./modules/operations.module.js"></script>
<script src="./directives/toolbar-search.js"></script>
<script src="./directives/toolbar-edit.js"></script>
<script src="./directives/truncate.js"></script>
<script src="./services/dialog.service.js"></script>
<!-- endinject -->

<script type="text/javascript">
    angular.module('myApp', [
            'swaggerUiMaterial',
            'swaggerUiMarkdown',
            'swaggerUiSort',
            'swaggerUiSplit',
            'swaggerUiYaml'
        ])
        .config(function ($mdThemingProvider) {
            var search = {};
            var query = window.location.search.substring(1);
            var vars = query.split('&');

            for (var i = 0; i < vars.length; i++) {
                var pair = vars[i].split('=');
                search[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);
            }

            $mdThemingProvider.definePalette('accent', $mdThemingProvider.extendPalette(search.accent || 'grey', {
                // tweaking md-button.md-accent.md-focused background-color
                '700': 'dadada'
            }));

            //noinspection JSUnresolvedFunction
            $mdThemingProvider
                .theme('default')
                .primaryPalette(search.primary || 'teal')
                .accentPalette('accent')
                .warnPalette(search.warn || 'amber')
                .foregroundPalette[3] = 'rgba(0, 0, 0, 0.4)';
        })
        .controller('MyCtrl', function ($scope, $location, $mdToast) {
            $scope.isLoading = false;
            //noinspection JSCheckFunctionSignatures
            $scope.swaggerUrl = $location.search()['url'] || 'http://petstore.swagger.io/v2/swagger.json';

            <!-- TODO: swaggerMethods should have default values -->
            $scope.swaggerMethods = {
                get: 'md-primary',
                head: 'md-primary md-hue-2',
                options: 'md-primary md-hue-3',
                post: 'md-accent',
                put: 'md-accent md-hue-2',
                patch: 'md-accent md-hue-2',
                delete: 'md-warn'
            };

            // error management
            $scope.myErrorHandler = function (data, status) {
                $mdToast.show($mdToast.simple().textContent('Failed to load :-('));
                console.error(status, data);
            };
        });
</script>
</body>
</html>
